# Chess Prompts Analysis

Библиотека для для анализа шахматных партий.

## Структура проекта

```
heuristic_extractor/
├── prompt_lib.py           # Класс Prompt для работы с промптами и получения ответов от модели
├── verifier.py             # Класс ResponseVerifier для верификации ответов
├── test_all_prompts.py     # Скрипт для тестирования всех промптов
└── prompts/                # Папка с промптами, сгруппированными по типу верификации
    ├── single/
    │   └── prompt.txt      # Промпт для ответа типа [int, int]
    ├── single_with_score/
    │   └── prompt.txt      # Промпт для ответа типа [int, int, int]
    ├── multiple/
    │   └── prompt.txt      # Промпт для ответа типа [[int, int], [int, int], ...]
    └── multiple_with_score/
        └── prompt.txt      # Промпт для ответа типа [[int, int, int], [int, int, int], ...]
```

## Описание компонентов

### prompt_lib.py

Содержит класс `Prompt`, который:
- Инициализируется с текстом промпта, моделью, провайдером и функцией верификации.
- Метод `get_response` отправляет запрос к модели, объединяя основной текст промпта с дополнительным контекстом, и обрабатывает ответ (выделяет часть после тега `</think>`, если он присутствует).
- Метод `get_verified_response` получает ответ и применяет функцию верификации (если она задана), иначе пытается разобрать JSON.

### verifier.py

Содержит класс `ResponseVerifier`, который позволяет проверять корректность ответа в зависимости от ожидаемого формата:
- **single**: Ответ должен быть списком из двух целых чисел, например: `[start, end]`.
- **single_with_score**: Ответ должен быть списком из трёх целых чисел, где третий элемент (score) входит в заданный диапазон (по умолчанию от 1 до 10).
- **multiple**: Ответ – список списков, где каждый внутренний список содержит два целых числа.
- **multiple_with_score**: Ответ – список списков, где каждый внутренний список содержит три целых числа с проверкой диапазона для оценки.

### test_all_prompts.py

Скрипт для тестирования промптов. Он:
- Проходит по папкам с промптами (`prompts/single`, `prompts/single_with_score`, `prompts/multiple`, `prompts/multiple_with_score`).
- Читает текст промпта из файла.
- Создает соответствующий верификатор.
- Выводит результат верификации для каждого типа промпта.

## запуск

1. **Запуск тестов:**

   Чтобы запустить тестирование всех промптов, выполните:

   ```bash
   python test_all_prompts.py
   ```

   Скрипт выведет результаты для каждого типа промпта, используя заранее заданные заглушки.

